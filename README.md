# Hive-movie-dataset

# Finding the most preferred movie genres for every user

In this I am finding the most preferred movie genres for every user by writing a hive query that takes in a movie rating dataset and for every user:

•	Calculates the average ratings provided by that user for various movie genres, and also
•	Returns the top five genres for each user. The output is sorted first by the user and then by the average rating.
 There are two input files used:
 
•	Movies.dat : this file consists of movies information and comprises of the following format (genres are delimited by “|”) : 

Movie_id#movie_title#genre1|genre2|genre3|… 

•	Ratings.dat : This file comprises of ratings given by users to different movies and has the following format:

 UserID#MovieID#Rating#Timestamp


Hints on preprocessing the input files and creating hive tables:

Before writing our hive script, we want every genre for a particular movie to be in its own particular row; for example,

Instead of:

2#Jumanji (1995)#Adventure|Children's|Fantasy

You want to produce:

2#Jumanji (1995)#Adventure

2#Jumanji (1995)# Children's

2#Jumanji (1995)# Fantasy

We can accomplish this in two different ways:

a.	OptionA: You can write a Map-Reduce job to parse each line of the movies.dat and send out several pairs of (movie_id , genre) for each input line. For example, for the input line 2#Jumanji (1995)#Adventure|Children's|Fantasy, your mapper can emit the following key-value pairs (2, Adventure), (2,Children’s) and (2,Fantasy). You can then use the above output that is generated by this Map-Reduce program and use it in your hive query.

b.	OptionB: You can use an array to store all genres for a movie while creating a table in hive. The genres are separated by ‘|’, so when creating a table you need to specify that the collection items are separated by ‘|’. Then to put each genre in its own row, you can make use of the “Expand” function along with “Lateral view”. 

Note: This can be done with the help of hive built-in rank function.

Running your Hive Script 
The size of the data is 25MB.

Here are the first few lines of the output I get when I run my solution using option B.

1 War 5.0 

1 Drama 4.428571 

1 Sci-Fi 4.3333335 

1 Musical 4.285714

1 Children's 4.25 

2 Western 4.3333335 

2 Film-Noir 4.0 

2 Drama 3.898734 

2 Adventure 3.7368422 

2 War 3.7333333 

3 Western 4.6666665 

3 Fantasy 4.5

3 Adventure 4.0

